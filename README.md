# 智能法律咨询系统 (Intelligent Legal Consultation System)

一个基于大语言模型的智能法律咨询平台，专注于劳动法领域，为用户提供合同分析、法律知识咨询和案件策略建议等服务。

## 📋 项目概述

本系统是一个综合性的法律咨询平台，集成了多个AI模型和专业法律知识库，能够为用户提供：

- **合同智能分析**：自动识别合同类型，检测合规性问题
- **法律知识咨询**：提供专业的法律条文解释和实用建议
- **案件策略咨询**：针对具体劳动争议案件提供专业分析
- **智能对话系统**：基于专业律师提示词的交互式咨询

## 🚀 核心功能

### 1. 合同分析模块
- **多格式支持**：支持PDF、Word文档、图片等多种格式
- **智能识别**：自动识别合同类型（固定期限、无固定期限、劳务派遣等）
- **合规检查**：检查关键条款的完整性和合规性
- **公章检测**：通过OCR和图像处理技术检测合同公章
- **风险评估**：识别潜在的法律风险和漏洞

### 2. 法律知识咨询
- **专业解答**：基于法律条文提供准确的法律知识
- **通俗易懂**：用简单明了的语言解释复杂法律概念
- **实用建议**：针对具体情况给出可操作的建议
- **多领域覆盖**：涵盖劳动法、民事法、婚姻家庭法等多个领域

### 3. 案件策略咨询
- **案件分类**：自动识别劳动争议案件类型
- **专业引导**：基于专业律师提示词进行结构化询问
- **证据收集**：指导用户收集和整理关键证据
- **策略建议**：提供专业的维权策略和法律程序指导

### 4. 智能对话系统
- **多轮对话**：支持连续的多轮对话交互
- **上下文理解**：保持对话上下文，提供连贯的咨询服务
- **用户状态管理**：为每个用户维护独立的对话状态
- **历史记录**：自动保存用户的咨询历史

## 🛠️ 技术架构

### 核心技术栈
- **前端界面**：Gradio - 提供直观的Web界面
- **后端框架**：Python + FastAPI
- **AI模型**：
  - 通义千问 (Qwen-max-latest) - 法律咨询和案件分析
  - DeepSeek - 合同分析专用模型
- **文档处理**：
  - PyPDF2 - PDF文档解析
  - python-docx - Word文档处理
  - EasyOCR - 图像文字识别
- **图像处理**：OpenCV - 公章检测和图像分析

### 系统架构
```
├── app.py              # 主应用入口和Gradio界面
├── config.py           # 配置文件（API密钥、模型配置等）
├── services.py         # 核心服务模块
│   ├── ContractAnalyzer        # 合同分析服务
│   ├── CaseAnalysisGenerator   # 案件分析生成器
│   ├── ParalegalAssistant      # 法律助理服务
│   └── LawyerPromptLoader      # 律师提示词加载器
├── utils.py            # 工具函数
├── prompts.py          # 系统提示词
├── lawyer_prompts/     # 专业律师提示词库
└── user_histories/     # 用户对话历史存储
```

## 📦 安装配置

### 环境要求
- Python 3.8+
- 操作系统：Windows/Linux/macOS
- 内存：建议4GB以上
- 网络：需要访问外部AI模型API

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd lawyer_free
```

2. **安装依赖**
```bash
cd legal_system_project
pip install -r requirements.txt
```

3. **配置API密钥**

编辑 `config.py` 文件，设置您的API密钥：
```python
# 通义千问API密钥
DASHSCOPE_API_KEY = "your-dashscope-api-key"

# DeepSeek API密钥
DEEPSEEK_API_KEY = "your-deepseek-api-key"
```

或者设置环境变量：
```bash
export DASHSCOPE_API_KEY="your-dashscope-api-key"
```

4. **启动应用**
```bash
# 启动主应用
cd legal_system_project
python app.py
```

应用将在 `http://localhost:7861` 启动。

5. **测试安装**（可选）
```bash
# 运行Gradio测试程序
python Test_Gradio.py
```

测试程序将在 `http://localhost:7860` 启动，用于验证Gradio环境是否正常工作。

## 🚀 快速开始

### 第一次使用

1. **启动系统**
   ```bash
   cd legal_system_project
   python app.py
   ```

2. **访问界面**
   打开浏览器访问：`http://localhost:7861`

3. **选择功能**
   - 💬 **法律咨询**：直接在对话框输入问题
   - 📄 **合同分析**：上传合同文件进行分析
   - ⚖️ **案件咨询**：描述具体案件获得专业建议

### 示例对话

**法律知识咨询示例：**
```
用户：公司要求我签竞业限制协议，这合法吗？
系统：竞业限制协议在法律上是被允许的，但需要满足特定条件...
```

**案件咨询示例：**
```
用户：我被公司无故辞退了，想要赔偿
系统：我理解您的困扰。为了更好地帮助您，请告诉我您的具体情况...
```

**合同分析示例：**
- 上传劳动合同PDF文件
- 系统自动识别为"固定期限劳动合同"
- 生成详细的合规性分析报告

## 📖 使用指南

### 合同分析
1. 点击"选择文件"按钮上传合同文件
2. 支持的格式：PDF、Word文档、图片（PNG、JPG等）
3. 点击"开始分析合同"按钮
4. 系统将自动识别合同类型并生成详细的合规分析报告

### 法律知识咨询
1. 在对话框中直接输入您的法律问题
2. 系统会自动识别问题类型并提供专业解答
3. 可以进行多轮对话，深入探讨具体问题

### 案件策略咨询
1. 描述您遇到的劳动争议情况
2. 系统会自动识别案件类型（确认劳动关系、合同争议等）
3. 专业律师AI将引导您提供关键信息
4. 获得针对性的法律建议和维权策略

## 🎯 支持的案件类型

系统专门针对以下劳动争议案件类型进行了优化：

1. **确认劳动关系争议**
2. **劳动合同争议**（订立、履行、变更、解除和终止）
3. **除名、辞退、辞职、离职争议**
4. **工作时间、休息休假、社会保险、福利争议**
5. **劳动报酬、工伤医疗费、经济补偿争议**

每种案件类型都配备了专门的律师提示词，确保提供最专业的咨询服务。

## 📁 项目结构

```
lawyer_free/
├── Test_Gradio.py              # Gradio环境测试程序
├── case_analysis_results/      # 案件分析结果存储
├── conversation_datasets/      # 对话数据集
├── user_histories/             # 全局用户历史记录
└── legal_system_project/       # 主项目目录
    ├── app.py                  # 主应用文件
    ├── config.py               # 配置文件
    ├── services.py             # 核心服务模块
    ├── utils.py                # 工具函数
    ├── prompts.py              # 系统提示词
    ├── requirements.txt        # 依赖包列表
    ├── lawyer_prompts/         # 律师提示词目录
    │   ├── lawyer01.txt       # 确认劳动关系争议
    │   ├── lawyer02.txt       # 劳动合同争议
    │   ├── lawyer03.txt       # 除名辞退争议
    │   ├── lawyer04.txt       # 工作时间福利争议
    │   ├── lawyer05.txt       # 劳动报酬争议
    │   └── paralegal_prompt.txt # 法律助理提示词
    └── user_histories/         # 用户历史记录
```

## 🔧 配置说明

### 模型配置
- `LEGAL_MODEL`: 法律咨询模型（默认：qwen-max-latest）
- `LAWYER_MODEL`: 律师咨询模型（默认：qwen-max-latest）
- `CONTRACT_ANALYSIS_MODEL`: 合同分析模型（默认：deepseek-chat）
- `CASE_ANALYSIS_MODEL`: 案件分析模型（默认：deepseek-r1）

### 功能开关
- 支持多用户并发访问
- 自动保存用户对话历史
- 智能案件类型识别
- 合同公章检测

## 🚨 注意事项

1. **法律免责声明**：本系统提供的法律咨询仅供参考，不能替代专业律师的法律服务
2. **数据安全**：用户上传的文件和对话记录会被临时存储，请注意敏感信息保护
3. **API配额**：请确保您的API密钥有足够的调用配额
4. **网络要求**：需要稳定的网络连接以访问AI模型服务
5. **端口占用**：主应用使用7861端口，测试程序使用7860端口，请确保端口未被占用
6. **文件上传限制**：建议上传的合同文件大小不超过10MB

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进本项目：

1. Fork本项目
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启Pull Request

## 📄 许可证

本项目采用MIT许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 📈 版本信息

**当前版本：v1.0.0**

### 主要特性
- ✅ 智能合同分析与合规检查
- ✅ 多轮对话法律咨询
- ✅ 专业案件策略建议
- ✅ 多格式文档支持
- ✅ 用户会话状态管理
- ✅ 历史记录保存

### 更新日志

**v1.0.0** (当前版本)
- 🎉 初始版本发布
- 🔧 集成通义千问和DeepSeek模型
- 📄 支持PDF、Word、图片格式合同分析
- ⚖️ 实现5类劳动争议案件专业咨询
- 🖥️ 基于Gradio的Web界面
- 💾 用户对话历史持久化存储

## 🔍 故障排除

### 常见问题

**Q: 启动时提示API密钥错误**
A: 请检查config.py中的API密钥配置，确保密钥有效且有足够配额。

**Q: 合同分析功能无法使用**
A: 请确保安装了所有依赖包，特别是easyocr和opencv-python。

**Q: 页面无法访问**
A: 检查防火墙设置，确保7861端口未被阻止。

**Q: 文件上传失败**
A: 检查文件格式是否支持，文件大小是否超限。

### 测试环境

运行测试程序验证环境：
```bash
python Test_Gradio.py
```

访问 `http://localhost:7860` 查看Gradio是否正常工作。

## 📞 联系方式

如有问题或建议，请通过以下方式联系：

- 项目Issues：[GitHub Issues]()
- 技术支持：[ultrasight@163.com](mailto:ultrasight@163.com)

---

**免责声明**：本系统提供的法律信息仅供参考，不构成正式的法律建议。在做出重要法律决策时，请咨询专业律师。